<section class="section" ng-controller="pageHeader">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-12">
                 <div class="component-layout">
                     <div class="page-header">
                         <div class="page-header__inner">
                             <h1 class="page-header__title">{{pageHeader.title.manageGuests}}</h1>
                             <h2 class="page-header__subtitle">{{pageHeader.subtitle.manageGuests}}</h2>
                         </div>
                     </div>
                 </div>
            </div>
        </div>
    </div>
</section>


<section class="section" ng-controller="mainController">
    <div class="container">
        <div class="row">
            <div class="col-sm-3">
                <h2 class="section-title">
                        <strong>Filtruj</strong><span> - wyszukaj po frazie</span>
                </h2>
                <form>
                    <div class="form-group form-group--modern">
                        <div class="form-group__input">
                            <i aria-hidden="true" class="fa fa-search form-group__icon"></i>
                            <input type="text" class="form-control form-control--modern" placeholder="Wpisz frazę..." ng-model="searchPerson">
                        </div>
                        <p>&nbsp;</p>
                    </div>
                </form>
            </div>
            <div class="col-sm-3">
                <h2 class="section-title">
                        <strong>Wydrukuj</strong><span> - tabele (np. przefiltrowaną)</span>
                </h2>
                 <a href="#" ng-click="printTable()" class="btn btn-primary btn-sm btn-block">Wydrukuj tabelę</a>
            </div>
        </div>
    </div>
    <div class="container-fluid" ng-controller="addNewGuest">
        <div class="row">
            <div class="col-xs-12">
                <h2 class="section-title">
                    <strong>Twoja lista gości</strong><span> - dane tabelaryczne</span>
                </h2>
                <table class="table table-bordered table-striped component table-management">
                    <thead>
                        <tr>
                            <td>#</td>
                            <td>
                                <a href="#" ng-click="sortType = 'firstName'; sortReverse = !sortReverse">
                                    Imię
                                    <span ng-show="sortType == 'firstName'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                                </a>
                            </td>
                            <td>
                                <a href="#" ng-click="sortType = 'surName'; sortReverse = !sortReverse">
                                    Nazwisko
                                    <span ng-show="sortType == 'surName'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                                </a>
                            </td>
                            <td>
                                <a href="#" ng-click="sortType = 'guestCount'; sortReverse = !sortReverse">
                                    Liczba osób
                                    <span ng-show="sortType == 'guestCount'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                                </a>
                            </td>
                            <td>
                                <a href="#" ng-click= "sortType = 'children'; sortReverse = !sortReverse">
                                    Dzieci
                                    <span ng-show="sortType == 'children'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                                </a>
                            </td>
                           <td>
                                <a href="#" ng-click= "sortType = 'membership'; sortReverse = !sortReverse">
                                    Przynależność
                                    <span ng-show="sortType == 'membership'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                                </a>
                            </td>
                            <td>
                                <a href="#" ng-click="sortType = 'status'; sortReverse = !sortReverse">
                                    Status
                                    <span ng-show="sortType == 'status'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                                </a>
                            </td>
                            <td>
                                Telefon
                            </td>
                            <td>
                                Extra inf.
                            </td>
                            <td>
                                Operacje
                            </td>
                        </tr>
                    </thead>

                    <tbody>
                    <tr ng-repeat="person in persons | orderBy:sortType:sortReverse | filter:searchPerson">
                        <td>{{ $index + 1 }}</td>
                        <td>{{ person.firstName }}</td>
                        <td>{{ person.surName }}</td>
                        <td>{{ person.guestCount }}</td>
                        <td>{{ person.children }}</td>
                        <td ng-class="{membershipWomen: person.membership === 'Pani Młoda', membershipMan: person.membership === 'Pan Młody'}">{{ person.membership }}</td>
                        <td ng-class="{refusal: person.status === 'Odmowa', unconfirmed: person.status === 'Oczekujący'}" class="table-management__status">
                            <span>{{ person.status }}</span>
                        </td>
                        <td>{{ person.phoneNumber }}</td>
                        <td>{{ person.extraInformation }}</td>
                        <!-- <td>{{ person.dataAdded }}</td> -->
                        <td class="text-center">
                            <button type="button" class="btn btn-primary btn-xs" data-toggle="modal" ng-attr-data-target="{{'#remove-person-modal--' + $index + 1}}">Usuń</button>
                            <button type="button" class="btn btn-primary btn-xs" data-toggle="modal" ng-attr-data-target="{{'#edit-person-modal--' + $index + 1}}">Edytuj</button>                                       <!-- Modal -->
                            <div class="modal fade" ng-attr-id="{{'remove-person-modal--' + $index + 1}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" title="Rezygunuję" data-dismiss="modal" aria-label="Rezygnuję"><span aria-hidden="true">&times;</span></button>
                                        <h4 class="modal-title" id="myModalLabel">Czy chcesz <code>usunąć</code> tego gościa z bazy danych?</h4>
                                    </div>
                                    <div class="modal-body">
                                        <p>Gość który zostanie usunięty to: <strong>{{ person.firstName }} {{ person.surName }}</strong></p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default dismiss-modal" data-dismiss="modal">Rezygnuję</button>
                                        <button type="button" class="btn btn-primary" ng-click="removeIt(person)" data-dismiss="modal">Usuń permanentnie</button>
                                    </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal fade" ng-attr-id="{{'edit-person-modal--' + $index + 1}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" title="Rezygunuję" data-dismiss="modal" aria-label="Rezygnuję"><span aria-hidden="true">&times;</span></button>
                                        <h4 class="modal-title" id="myModalLabel">Czy chcesz <code>edytować</code> tego gościa?</h4>
                                    </div>
                                    <div class="modal-body">
                                        <p>Gość który zostanie edytowany to: <strong>{{ person.firstName }} {{ person.surName }}</strong></p>
                                        <hr>
                                        <div class="form-group form-group--modern form-group--label">
                                            <label for="appFirstName" class="label">Podaj imię / imiona <span class="error" ng-show="formAddNewGuest.firstName.$error.required">*</span></label>
                                            <div class="form-group__input">
                                                <i aria-hidden="true" class="fa fa-user form-group__icon"></i>
                                                <input type="text" name="firstName" ng-model="person.firstName" id="appFirstName" class="form-control form-control--modern form-control--username"/>
                                            </div>
                                        </div>
                                        <div class="form-group form-group--modern form-group--label">
                                            <label for="appSurName" class="label">Podaj nazwisko<span class="error" ng-show="formAddNewGuest.surName.$error.required">*</span></label>
                                            <div class="form-group__input">
                                                <i aria-hidden="true" class="fa fa-user form-group__icon"></i>
                                                <input type="text" name="surName" ng-model="person.surName" id="appSurName" class="form-control form-control--modern form-control--username"/>
                                            </div>
                                        </div>
                                        <div class="form-group form-group--modern form-group--label">
                                            <label for="appGuestCount" class="label">Podaj przewidywaną liczbę osób *</label>
                                            <div class="form-group__input">
                                                <i aria-hidden="true" class="fa fa-user form-group__icon"></i>
                                                <input type="number" name="guestCount" ng-model="person.guestCount" id="appGuestCount" class="form-control form-control--modern form-control--username"/>
                                            </div>
                                        </div>
                                        <div class="form-group form-group--modern form-group--label">
                                            <label for="appGuestChildren" class="label">Podaj przewidywaną liczbę dzieci *</label>
                                            <div class="form-group__input">
                                                <i aria-hidden="true" class="fa fa-user form-group__icon"></i>
                                                <input type="number" name="children" ng-model="person.children" id="appGuestChildren" class="form-control form-control--modern form-control--username"/>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <p>Wybierz status:</p>
                                            <label>Potwierdzony
                                                <input type="radio" ng-model="person.status" value="Potwierdzony">
                                            </label><br/>
                                            <label>Oczekujący
                                                <input type="radio" ng-model="person.status" value="Oczekujący">
                                            </label><br/>
                                            <label>Odmowa
                                                <input type="radio" ng-model="person.status" value="Odmowa">
                                            </label>
                                        </div>
                                        <div class="form-group form-group--modern form-group--label">
                                            <label for="appGuestPhoneNumber" class="label">Zmodyfikuj numer telefonu</label>
                                            <div class="form-group__input">
                                                <i aria-hidden="true" class="fa fa-user form-group__icon"></i>
                                                <input type="text" name="phoneNumber" ng-model="person.phoneNumber" id="appGuestPhoneNumber" class="form-control form-control--modern form-control--username"/>
                                            </div>
                                        </div>
                                        <div class="form-group form-group--modern form-group--label">
                                            <label for="appGuestPhoneNumber" class="label">Informacje dodatkowe</label>
                                            <div class="form-group__input">
                                                <i aria-hidden="true" class="fa fa-user form-group__icon"></i>
                                                <textarea name="name" ng-model="person.extraInformation" class="form-control form-control--modern form-control--username form-control--textarea"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default dismiss-modal" data-dismiss="modal">Rezygnuję</button>
                                        <button type="button" ng-click="saveIt(person)" class="btn btn-success dismiss-modal" data-dismiss="modal">Zapisz zmiany</button>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    </tbody>

                </table>

            </div>

        </div>
    </div>
</section>
